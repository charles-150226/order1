<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>黄Net点单系统</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- GSAP 动画库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FFC107',
                        secondary: '#FF9800',
                        dark: '#333333',
                        light: '#FFFFFF',
                        gray: '#F5F5F5',
                        'gray-dark': '#E0E0E0'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'bounce-short': 'bounce 0.5s ease-in-out',
                        'fade-in': 'fadeIn 0.3s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-in-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .glass-effect {
                background: rgba(255, 255, 255, 0.7);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            }
            .text-shadow {
                text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }
    </style>
</head>
<body class="bg-gray min-h-screen flex flex-col">
    <!-- 顶部导航栏 -->
    <header class="bg-primary shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/09f58eb502174ef1b36b1a0ad783ec71~tplv-a9rns2rl98-image.image?lk3s=8e244e95&rcl=2026011713550486A6C8362103A84E589C&rrcfp=f06b921b&x-expires=1771221329&x-signature=IsEtif38kbmWMQW2lU1Ezz4Hc5Q%3D" alt="黄Net点单系统" class="h-10 w-10">
                <h1 class="text-2xl font-bold text-dark">黄Net点单系统</h1>
            </div>
            <div class="relative w-1/3">
                <input type="text" id="search-input" placeholder="搜索菜品..." class="w-full py-2 px-4 pr-10 rounded-full border-2 border-dark focus:outline-none focus:border-secondary transition-all">
                <button id="search-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-dark">
                    <i class="fa fa-search text-lg"></i>
                </button>
            </div>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-secondary transition-colors">
                    <i class="fa fa-moon-o text-dark text-xl"></i>
                </button>
                <div class="relative">
                    <button id="notification-btn" class="p-2 rounded-full hover:bg-secondary transition-colors">
                        <i class="fa fa-bell text-dark text-xl"></i>
                        <span class="absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 分类导航 -->
    <nav class="bg-white shadow-sm py-2 sticky top-16 z-40">
        <div class="container mx-auto px-4">
            <ul class="flex space-x-1 overflow-x-auto scrollbar-hide">
                <li>
                    <button class="category-btn active px-4 py-2 rounded-full bg-primary text-dark font-medium whitespace-nowrap transition-all" data-category="all">全部</button>
                </li>
                <li>
                    <button class="category-btn px-4 py-2 rounded-full hover:bg-gray-dark text-dark font-medium whitespace-nowrap transition-all" data-category="chinese">中餐</button>
                </li>
                <li>
                    <button class="category-btn px-4 py-2 rounded-full hover:bg-gray-dark text-dark font-medium whitespace-nowrap transition-all" data-category="western">西餐</button>
                </li>
                <li>
                    <button class="category-btn px-4 py-2 rounded-full hover:bg-gray-dark text-dark font-medium whitespace-nowrap transition-all" data-category="dessert">甜点</button>
                </li>
                <li>
                    <button class="category-btn px-4 py-2 rounded-full hover:bg-gray-dark text-dark font-medium whitespace-nowrap transition-all" data-category="drink">饮品</button>
                </li>
                <li>
                    <button class="category-btn px-4 py-2 rounded-full hover:bg-gray-dark text-dark font-medium whitespace-nowrap transition-all" data-category="recommended">推荐</button>
                </li>
            </ul>
        </div>
    </nav>

    <!-- 主要内容区 -->
    <main class="flex-grow container mx-auto px-4 py-6 flex flex-col md:flex-row gap-6">
        <!-- 左侧菜单区域 -->
        <section class="w-full md:w-2/3">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                    <i class="fa fa-cutlery mr-2 text-primary"></i>
                    菜单列表
                </h2>
                
                <!-- 智能推荐 -->
                <div id="recommended-section" class="mb-8">
                    <h3 class="text-xl font-semibold text-dark mb-4 flex items-center">
                        <i class="fa fa-star text-primary mr-2"></i>
                        智能推荐
                        <span class="ml-2 text-sm text-gray-500">(基于您的喜好)</span>
                    </h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- 推荐菜品将通过JS动态生成 -->
                    </div>
                </div>
                
                <!-- 菜品分类列表 -->
                <div id="menu-section">
                    <!-- 中餐 -->
                    <div class="category-section mb-8" data-category="chinese">
                        <h3 class="text-xl font-semibold text-dark mb-4 flex items-center">
                            <i class="fa fa-fire text-primary mr-2"></i>
                            中餐
                        </h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 中餐菜品将通过JS动态生成 -->
                        </div>
                    </div>
                    
                    <!-- 西餐 -->
                    <div class="category-section mb-8" data-category="western">
                        <h3 class="text-xl font-semibold text-dark mb-4 flex items-center">
                            <i class="fa fa-cutlery text-primary mr-2"></i>
                            西餐
                        </h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 西餐菜品将通过JS动态生成 -->
                        </div>
                    </div>
                    
                    <!-- 甜点 -->
                    <div class="category-section mb-8" data-category="dessert">
                        <h3 class="text-xl font-semibold text-dark mb-4 flex items-center">
                            <i class="fa fa-birthday-cake text-primary mr-2"></i>
                            甜点
                        </h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 甜点菜品将通过JS动态生成 -->
                        </div>
                    </div>
                    
                    <!-- 饮品 -->
                    <div class="category-section mb-8" data-category="drink">
                        <h3 class="text-xl font-semibold text-dark mb-4 flex items-center">
                            <i class="fa fa-glass text-primary mr-2"></i>
                            饮品
                        </h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 饮品菜品将通过JS动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 右侧订单区域 -->
        <aside class="w-full md:w-1/3">
            <div class="bg-white rounded-xl shadow-md p-6 sticky top-28">
                <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                    <i class="fa fa-shopping-cart mr-2 text-primary"></i>
                    当前订单
                    <span id="order-count" class="ml-auto bg-primary text-dark text-sm font-bold rounded-full h-6 w-6 flex items-center justify-center">0</span>
                </h2>
                
                <!-- 订单列表 -->
                <div id="order-list" class="mb-6 max-h-96 overflow-y-auto scrollbar-hide">
                    <!-- 订单为空状态 -->
                    <div id="empty-order" class="text-center py-10">
                        <i class="fa fa-shopping-cart text-gray-400 text-5xl mb-4"></i>
                        <p class="text-gray-500 text-lg">您的订单还是空的</p>
                        <p class="text-gray-400 text-sm mt-2">快去添加美味的菜品吧！</p>
                    </div>
                    
                    <!-- 订单菜品将通过JS动态生成 -->
                </div>
                
                <!-- 订单汇总 -->
                <div id="order-summary" class="border-t-2 border-gray-dark pt-4 mt-4 hidden">
                    <div class="flex justify-between mb-2">
                        <span class="text-dark">小计</span>
                        <span id="subtotal" class="font-semibold text-dark">¥0.00</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="text-dark">服务费</span>
                        <span id="service-fee" class="font-semibold text-dark">¥0.00</span>
                    </div>
                    <div class="flex justify-between mb-4 text-lg font-bold">
                        <span class="text-dark">总计</span>
                        <span id="total" class="text-primary">¥0.00</span>
                    </div>
                    
                    <!-- 备注 -->
                    <div class="mb-4">
                        <label for="order-notes" class="block text-dark mb-2">备注</label>
                        <textarea id="order-notes" class="w-full p-2 border-2 border-gray-dark rounded-lg focus:outline-none focus:border-primary resize-none" rows="2" placeholder="添加备注信息..."></textarea>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex space-x-3">
                        <button id="clear-order" class="flex-1 py-3 px-4 bg-gray-dark text-dark rounded-lg font-semibold hover:bg-gray transition-colors flex items-center justify-center">
                            <i class="fa fa-trash mr-2"></i>
                            清空
                        </button>
                        <button id="submit-order" class="flex-1 py-3 px-4 bg-primary text-dark rounded-lg font-semibold hover:bg-secondary transition-colors flex items-center justify-center">
                            <i class="fa fa-check mr-2"></i>
                            提交订单
                        </button>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- 提交订单成功弹窗 -->
    <div id="order-success-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 animate-fade-in">
            <div class="text-center">
                <div class="inline-flex items-center justify-center h-16 w-16 rounded-full bg-green-100 text-green-500 mb-4">
                    <i class="fa fa-check-circle text-4xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-dark mb-2">订单提交成功！</h3>
                <p class="text-gray-600 mb-6">您的订单已经提交，我们将尽快为您准备。</p>
                <p class="text-dark font-semibold mb-6">订单号：<span id="order-number" class="text-primary">#20230715001</span></p>
                
                <div class="flex justify-center">
                    <button id="close-modal" class="py-3 px-6 bg-primary text-dark rounded-lg font-semibold hover:bg-secondary transition-colors">
                        确定
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 菜品详情弹窗 -->
    <div id="dish-detail-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto animate-fade-in">
            <div class="flex justify-between items-start mb-4">
                <h3 id="detail-name" class="text-2xl font-bold text-dark"></h3>
                <button id="close-detail-modal" class="text-gray-500 hover:text-dark">
                    <i class="fa fa-times text-2xl"></i>
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <img id="detail-image" src="" alt="" class="w-full h-64 object-cover rounded-lg mb-4">
                    <div class="flex items-center mb-2">
                        <div class="flex text-yellow-400">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star-half-o"></i>
                        </div>
                        <span id="detail-rating" class="ml-2 text-dark">4.5 (120)</span>
                    </div>
                    <div class="flex items-center mb-4">
                        <span id="detail-price" class="text-2xl font-bold text-primary"></span>
                        <span class="ml-2 text-gray-500">/ 份</span>
                    </div>
                </div>
                
                <div>
                    <div class="mb-4">
                        <h4 class="text-lg font-semibold text-dark mb-2">菜品描述</h4>
                        <p id="detail-description" class="text-gray-600"></p>
                    </div>
                    
                    <div class="mb-4">
                        <h4 class="text-lg font-semibold text-dark mb-2">配料</h4>
                        <p id="detail-ingredients" class="text-gray-600"></p>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-dark mb-2">营养信息</h4>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="bg-gray p-2 rounded-lg text-center">
                                <span id="detail-calories" class="block font-semibold text-dark">0</span>
                                <span class="text-xs text-gray-500">卡路里</span>
                            </div>
                            <div class="bg-gray p-2 rounded-lg text-center">
                                <span id="detail-protein" class="block font-semibold text-dark">0g</span>
                                <span class="text-xs text-gray-500">蛋白质</span>
                            </div>
                            <div class="bg-gray p-2 rounded-lg text-center">
                                <span id="detail-fat" class="block font-semibold text-dark">0g</span>
                                <span class="text-xs text-gray-500">脂肪</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center border-2 border-primary rounded-lg">
                            <button id="decrease-quantity" class="px-3 py-2 text-dark hover:bg-gray-dark rounded-l-lg">
                                <i class="fa fa-minus"></i>
                            </button>
                            <span id="detail-quantity" class="px-4 py-2 font-semibold text-dark">1</span>
                            <button id="increase-quantity" class="px-3 py-2 text-dark hover:bg-gray-dark rounded-r-lg">
                                <i class="fa fa-plus"></i>
                            </button>
                        </div>
                        <button id="add-to-order-detail" class="flex-1 py-3 px-4 bg-primary text-dark rounded-lg font-semibold hover:bg-secondary transition-colors">
                            <i class="fa fa-shopping-cart mr-2"></i>
                            添加到订单
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 菜品数据
        const dishes = [
            // 中餐
            {
                id: 1,
                name: '红烧黄花鱼',
                price: 68.00,
                description: '新鲜黄花鱼配以特制红烧酱汁，肉质鲜嫩，口感丰富',
                category: 'chinese',
                image: 'https://p26-doubao-search-sign.byteimg.com/tos-cn-i-be4g95zd3a/1370118911371378714~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=8D52q5Mfu5RUbkEiCydaWvhl8kM%3D',
                ingredients: '黄花鱼、姜、蒜、葱、酱油、糖、料酒',
                calories: 320,
                protein: 25,
                fat: 18,
                rating: 4.8,
                reviews: 156,
                recommended: true,
                popular: true
            },
            {
                id: 2,
                name: '油爆黑虎虾',
                price: 88.00,
                description: '精选黑虎虾，配以青红椒爆炒，口感爽脆，香辣可口',
                category: 'chinese',
                image: 'https://p26-doubao-search-sign.byteimg.com/tos-cn-i-be4g95zd3a/1488294335286214661~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=koLx9qxyGTBI%2BDCr9CoFNKDL4z8%3D',
                ingredients: '黑虎虾、青椒、红椒、姜、蒜、葱、干辣椒',
                calories: 280,
                protein: 32,
                fat: 15,
                rating: 4.6,
                reviews: 132,
                recommended: true,
                popular: true
            },
            {
                id: 3,
                name: '麻婆豆腐',
                price: 32.00,
                description: '传统川菜，豆腐嫩滑，配以麻辣鲜香的豆瓣酱，口感丰富',
                category: 'chinese',
                image: 'https://p3-doubao-search-sign.byteimg.com/tos-cn-i-be4g95zd3a/1471219134377361410~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=u%2B9LETvCJvcllt9U9kiqri0FWAs%3D',
                ingredients: '豆腐、牛肉末、豆瓣酱、花椒、干辣椒、葱、蒜',
                calories: 240,
                protein: 12,
                fat: 18,
                rating: 4.5,
                reviews: 98,
                recommended: false,
                popular: true
            },
            
            // 西餐
            {
                id: 4,
                name: '黑椒牛排',
                price: 128.00,
                description: '精选澳洲进口牛排，配以黑椒酱汁，外焦里嫩，口感极佳',
                category: 'western',
                image: 'https://p3-doubao-search-sign.byteimg.com/labis/ad2e2eaf3ec70e9ec25454d11c194d49~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=PyJMZiIXIT8vAMTb8fD5V0VnAVc%3D',
                ingredients: '牛排、黑胡椒、盐、橄榄油、迷迭香、大蒜',
                calories: 450,
                protein: 38,
                fat: 28,
                rating: 4.9,
                reviews: 203,
                recommended: true,
                popular: true
            },
            {
                id: 5,
                name: '金枪鱼蔬菜沙拉',
                price: 48.00,
                description: '新鲜蔬菜搭配金枪鱼，营养均衡，健康美味',
                category: 'western',
                image: 'https://p3-doubao-search-sign.byteimg.com/tos-cn-i-be4g95zd3a/1644908436432093184~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=AsE9W6R33vO%2F2EaoN1YLER%2FV%2FL0%3D',
                ingredients: '金枪鱼、混合生菜、西红柿、黄瓜、鸡蛋、玉米粒、橄榄油',
                calories: 220,
                protein: 20,
                fat: 12,
                rating: 4.4,
                reviews: 87,
                recommended: false,
                popular: false
            },
            
            // 甜点
            {
                id: 6,
                name: '星空蛋糕',
                price: 58.00,
                description: '创意甜点，蓝紫色渐变的奶油，点缀星星形状的巧克力，颜值与口感并存',
                category: 'dessert',
                image: 'https://p3-doubao-search-sign.byteimg.com/pgc-image/290801e458824fe0b1433cccca5b98c9~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=qFWVGiMRAkV7seB0QtKmmoDYSaQ%3D',
                ingredients: '面粉、鸡蛋、奶油、糖、食用色素、巧克力',
                calories: 380,
                protein: 5,
                fat: 22,
                rating: 4.7,
                reviews: 145,
                recommended: true,
                popular: true
            },
            {
                id: 7,
                name: '彩虹蛋糕',
                price: 48.00,
                description: '多层彩虹色蛋糕，口感松软，奶油香甜不腻',
                category: 'dessert',
                image: 'https://p3-doubao-search-sign.byteimg.com/pgc-image/079f3d2cd70e43afb131a5cfa8388e7a~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=LnS3G5cTwoWfQXosTzd1BLBbb24%3D',
                ingredients: '面粉、鸡蛋、奶油、糖、食用色素',
                calories: 350,
                protein: 4,
                fat: 20,
                rating: 4.6,
                reviews: 128,
                recommended: false,
                popular: true
            },
            
            // 饮品
            {
                id: 8,
                name: '猕猴桃气泡水',
                price: 28.00,
                description: '新鲜猕猴桃汁搭配气泡水，清爽解渴，富含维生素C',
                category: 'drink',
                image: 'https://p11-doubao-search-sign.byteimg.com/labis/3c8a9f47a68dcef07264e95612d48b3c~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=UnJ%2FnjmBncmbWh11XvLyumTK1KU%3D',
                ingredients: '猕猴桃、气泡水、糖浆、冰块',
                calories: 120,
                protein: 1,
                fat: 0,
                rating: 4.3,
                reviews: 76,
                recommended: false,
                popular: false
            },
            {
                id: 9,
                name: '烧仙草奶茶',
                price: 32.00,
                description: '香浓奶茶搭配Q弹烧仙草，口感丰富，是消暑的最佳选择',
                category: 'drink',
                image: 'https://p3-doubao-search-sign.byteimg.com/labis/b8d76ed87891e2441b8597e711c66774~tplv-be4g95zd3a-image.jpeg?lk3s=feb11e32&x-expires=1784181311&x-signature=BV7hRXU%2F%2FfsJxi2dvKgXW2F4cHg%3D',
                ingredients: '奶茶、烧仙草、椰果、珍珠',
                calories: 220,
                protein: 3,
                fat: 8,
                rating: 4.8,
                reviews: 167,
                recommended: true,
                popular: true
            }
        ];

        // 订单数据
        let order = [];
        let currentDetailDish = null;
        let detailQuantity = 1;

        // DOM 加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化页面
            initializePage();
            
            // 绑定事件
            bindEvents();
        });

        // 初始化页面
        function initializePage() {
            // 渲染推荐菜品
            renderRecommendedDishes();
            
            // 渲染各分类菜品
            renderCategoryDishes();
            
            // 初始化订单状态
            updateOrderUI();
        }

        // 渲染推荐菜品
        function renderRecommendedDishes() {
            const recommendedDishes = dishes.filter(dish => dish.recommended);
            const recommendedSection = document.querySelector('#recommended-section .grid');
            
            recommendedSection.innerHTML = '';
            
            recommendedDishes.forEach(dish => {
                recommendedSection.innerHTML += createDishCardHTML(dish);
            });
        }

        // 渲染各分类菜品
        function renderCategoryDishes() {
            const categories = ['chinese', 'western', 'dessert', 'drink'];
            
            categories.forEach(category => {
                const categoryDishes = dishes.filter(dish => dish.category === category);
                const categorySection = document.querySelector(`.category-section[data-category="${category}"] .grid`);
                
                categorySection.innerHTML = '';
                
                categoryDishes.forEach(dish => {
                    categorySection.innerHTML += createDishCardHTML(dish);
                });
            });
        }

        // 创建菜品卡片HTML
        function createDishCardHTML(dish) {
            return `
                <div class="dish-card card-hover bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" data-id="${dish.id}">
                    <div class="relative">
                        <img src="${dish.image}" alt="${dish.name}" class="w-full h-48 object-cover">
                        ${dish.popular ? '<span class="absolute top-2 right-2 bg-secondary text-white text-xs font-bold px-2 py-1 rounded-full">热门</span>' : ''}
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-dark mb-1">${dish.name}</h4>
                        <p class="text-primary font-bold text-xl mb-2">¥${dish.price.toFixed(2)}</p>
                        <p class="text-gray-600 text-sm mb-3 line-clamp-2">${dish.description}</p>
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="flex text-yellow-400">
                                    ${getRatingStars(dish.rating)}
                                </div>
                                <span class="ml-1 text-xs text-gray-500">${dish.rating} (${dish.reviews})</span>
                            </div>
                            <button class="add-to-order-btn p-2 bg-primary text-dark rounded-full hover:bg-secondary transition-colors" data-id="${dish.id}">
                                <i class="fa fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // 获取评分星星HTML
        function getRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fa fa-star"></i>';
            }
            
            if (halfStar) {
                stars += '<i class="fa fa-star-half-o"></i>';
            }
            
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="fa fa-star-o"></i>';
            }
            
            return stars;
        }

        // 绑定事件
        function bindEvents() {
            // 分类切换
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // 移除所有按钮的active状态
                    document.querySelectorAll('.category-btn').forEach(b => {
                        b.classList.remove('active', 'bg-primary');
                        b.classList.add('hover:bg-gray-dark');
                    });
                    
                    // 添加当前按钮的active状态
                    this.classList.add('active', 'bg-primary');
                    this.classList.remove('hover:bg-gray-dark');
                    
                    // 获取选中的分类
                    const category = this.getAttribute('data-category');
                    
                    // 显示对应的分类
                    if (category === 'all') {
                        document.querySelectorAll('.category-section').forEach(section => {
                            section.style.display = 'block';
                        });
                        document.getElementById('recommended-section').style.display = 'block';
                    } else if (category === 'recommended') {
                        document.querySelectorAll('.category-section').forEach(section => {
                            section.style.display = 'none';
                        });
                        document.getElementById('recommended-section').style.display = 'block';
                    } else {
                        document.querySelectorAll('.category-section').forEach(section => {
                            if (section.getAttribute('data-category') === category) {
                                section.style.display = 'block';
                            } else {
                                section.style.display = 'none';
                            }
                        });
                        document.getElementById('recommended-section').style.display = 'none';
                    }
                });
            });
            
            // 搜索功能
            document.getElementById('search-btn').addEventListener('click', performSearch);
            document.getElementById('search-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            // 菜品卡片点击事件（事件委托）
            document.querySelectorAll('.category-section .grid, #recommended-section .grid').forEach(grid => {
                grid.addEventListener('click', function(e) {
                    // 检查是否点击了菜品卡片
                    const dishCard = e.target.closest('.dish-card');
                    if (dishCard) {
                        const dishId = parseInt(dishCard.getAttribute('data-id'));
                        showDishDetail(dishId);
                    }
                    
                    // 检查是否点击了添加到订单按钮
                    const addBtn = e.target.closest('.add-to-order-btn');
                    if (addBtn) {
                        e.stopPropagation(); // 阻止事件冒泡
                        const dishId = parseInt(addBtn.getAttribute('data-id'));
                        addToOrder(dishId, 1);
                        
                        // 添加按钮动画
                        addBtn.classList.add('animate-bounce-short');
                        setTimeout(() => {
                            addBtn.classList.remove('animate-bounce-short');
                        }, 500);
                    }
                });
            });
            
            // 详情弹窗中的数量调整
            document.getElementById('decrease-quantity').addEventListener('click', function() {
                if (detailQuantity > 1) {
                    detailQuantity--;
                    document.getElementById('detail-quantity').textContent = detailQuantity;
                }
            });
            
            document.getElementById('increase-quantity').addEventListener('click', function() {
                detailQuantity++;
                document.getElementById('detail-quantity').textContent = detailQuantity;
            });
            
            // 详情弹窗中的添加到订单
            document.getElementById('add-to-order-detail').addEventListener('click', function() {
                if (currentDetailDish) {
                    addToOrder(currentDetailDish.id, detailQuantity);
                    closeDetailModal();
                }
            });
            
            // 关闭详情弹窗
            document.getElementById('close-detail-modal').addEventListener('click', closeDetailModal);
            
            // 清空订单
            document.getElementById('clear-order').addEventListener('click', clearOrder);
            
            // 提交订单
            document.getElementById('submit-order').addEventListener('click', submitOrder);
            
            // 关闭成功弹窗
            document.getElementById('close-modal').addEventListener('click', function() {
                document.getElementById('order-success-modal').classList.add('hidden');
                // 询问用户是否清空订单
                if (confirm('订单已提交成功！是否清空当前订单以开始新的点餐？')) {
                    clearOrder();
                }
            });
            
            // 主题切换
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
        }

        // 执行搜索
        function performSearch() {
            const searchTerm = document.getElementById('search-input').value.trim().toLowerCase();
            
            if (searchTerm === '') {
                // 如果搜索框为空，恢复所有菜品显示
                document.querySelectorAll('.dish-card').forEach(card => {
                    card.style.display = 'block';
                });
                return;
            }
            
            // 搜索菜品
            document.querySelectorAll('.dish-card').forEach(card => {
                const dishId = parseInt(card.getAttribute('data-id'));
                const dish = dishes.find(d => d.id === dishId);
                
                if (dish && (
                    dish.name.toLowerCase().includes(searchTerm) || 
                    dish.description.toLowerCase().includes(searchTerm) ||
                    dish.ingredients.toLowerCase().includes(searchTerm)
                )) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
            
            // 显示搜索结果提示
            const visibleCards = document.querySelectorAll('.dish-card[style*="display: block"]');
            if (visibleCards.length === 0) {
                alert('没有找到匹配的菜品，请尝试其他关键词');
            }
        }

        // 显示菜品详情
        function showDishDetail(dishId) {
            const dish = dishes.find(d => d.id === dishId);
            
            if (!dish) return;
            
            // 设置当前详情菜品
            currentDetailDish = dish;
            detailQuantity = 1;
            
            // 填充详情数据
            document.getElementById('detail-name').textContent = dish.name;
            document.getElementById('detail-image').src = dish.image;
            document.getElementById('detail-image').alt = dish.name;
            document.getElementById('detail-price').textContent = `¥${dish.price.toFixed(2)}`;
            document.getElementById('detail-description').textContent = dish.description;
            document.getElementById('detail-ingredients').textContent = dish.ingredients;
            document.getElementById('detail-calories').textContent = dish.calories;
            document.getElementById('detail-protein').textContent = `${dish.protein}g`;
            document.getElementById('detail-fat').textContent = `${dish.fat}g`;
            document.getElementById('detail-rating').textContent = `${dish.rating} (${dish.reviews})`;
            document.getElementById('detail-quantity').textContent = detailQuantity;
            
            // 显示弹窗
            document.getElementById('dish-detail-modal').classList.remove('hidden');
        }

        // 关闭详情弹窗
        function closeDetailModal() {
            document.getElementById('dish-detail-modal').classList.add('hidden');
            currentDetailDish = null;
        }

        // 添加到订单
        function addToOrder(dishId, quantity) {
            const dish = dishes.find(d => d.id === dishId);
            
            if (!dish) return;
            
            // 检查订单中是否已有该菜品
            const existingItem = order.find(item => item.id === dishId);
            
            if (existingItem) {
                // 如果已有，增加数量
                existingItem.quantity += quantity;
            } else {
                // 如果没有，添加新项
                order.push({
                    id: dish.id,
                    name: dish.name,
                    price: dish.price,
                    image: dish.image,
                    quantity: quantity
                });
            }
            
            // 更新订单UI
            updateOrderUI();
            
            // 显示添加成功提示
            showToast(`已添加 ${quantity} 份 ${dish.name} 到订单`);
        }

        // 更新订单UI
        function updateOrderUI() {
            const orderList = document.getElementById('order-list');
            const emptyOrder = document.getElementById('empty-order');
            const orderSummary = document.getElementById('order-summary');
            const orderCount = document.getElementById('order-count');
            
            // 更新订单数量
            orderCount.textContent = order.reduce((total, item) => total + item.quantity, 0);
            
            // 如果订单为空，显示空状态
            if (order.length === 0) {
                emptyOrder.classList.remove('hidden');
                orderSummary.classList.add('hidden');
                
                // 清空订单列表
                const orderItems = orderList.querySelectorAll('.order-item');
                orderItems.forEach(item => item.remove());
                
                return;
            }
            
            // 如果订单不为空，隐藏空状态，显示汇总
            emptyOrder.classList.add('hidden');
            orderSummary.classList.remove('hidden');
            
            // 清空订单列表
            const orderItems = orderList.querySelectorAll('.order-item');
            orderItems.forEach(item => item.remove());
            
            // 添加订单菜品
            order.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'order-item flex items-center py-3 border-b border-gray-dark animate-fade-in';
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg mr-3">
                    <div class="flex-grow">
                        <h4 class="font-semibold text-dark">${item.name}</h4>
                        <p class="text-primary font-bold">¥${item.price.toFixed(2)}</p>
                    </div>
                    <div class="flex items-center">
                        <button class="decrease-order-btn px-2 py-1 bg-gray-dark text-dark rounded-l hover:bg-gray transition-colors" data-id="${item.id}">
                            <i class="fa fa-minus"></i>
                        </button>
                        <span class="px-3 py-1 font-semibold text-dark border-t border-b border-gray-dark">${item.quantity}</span>
                        <button class="increase-order-btn px-2 py-1 bg-gray-dark text-dark rounded-r hover:bg-gray transition-colors" data-id="${item.id}">
                            <i class="fa fa-plus"></i>
                        </button>
                        <button class="remove-order-btn ml-2 p-2 text-gray-500 hover:text-red-500 transition-colors" data-id="${item.id}">
                            <i class="fa fa-trash"></i>
                        </button>
                    </div>
                `;
                
                orderList.appendChild(itemElement);
            });
            
            // 绑定订单菜品的事件
            document.querySelectorAll('.decrease-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dishId = parseInt(this.getAttribute('data-id'));
                    decreaseOrderItem(dishId);
                });
            });
            
            document.querySelectorAll('.increase-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dishId = parseInt(this.getAttribute('data-id'));
                    increaseOrderItem(dishId);
                });
            });
            
            document.querySelectorAll('.remove-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dishId = parseInt(this.getAttribute('data-id'));
                    removeOrderItem(dishId);
                });
            });
            
            // 更新订单汇总
            updateOrderSummary();
        }

        // 减少订单菜品数量
        function decreaseOrderItem(dishId) {
            const item = order.find(item => item.id === dishId);
            
            if (!item) return;
            
            if (item.quantity > 1) {
                item.quantity--;
            } else {
                // 如果数量为1，询问是否删除
                if (confirm(`确定要从订单中移除 ${item.name} 吗？`)) {
                    order = order.filter(item => item.id !== dishId);
                } else {
                    return;
                }
            }
            
            // 更新订单UI
            updateOrderUI();
        }

        // 增加订单菜品数量
        function increaseOrderItem(dishId) {
            const item = order.find(item => item.id === dishId);
            
            if (!item) return;
            
            item.quantity++;
            
            // 更新订单UI
            updateOrderUI();
        }

        // 移除订单菜品
        function removeOrderItem(dishId) {
            const item = order.find(item => item.id === dishId);
            
            if (!item) return;
            
            if (confirm(`确定要从订单中移除 ${item.name} 吗？`)) {
                order = order.filter(item => item.id !== dishId);
                
                // 更新订单UI
                updateOrderUI();
            }
        }

        // 更新订单汇总
        function updateOrderSummary() {
            // 计算小计
            const subtotal = order.reduce((total, item) => total + (item.price * item.quantity), 0);
            
            // 计算服务费（假设为小计的10%）
            const serviceFee = subtotal * 0.1;
            
            // 计算总计
            const total = subtotal + serviceFee;
            
            // 更新显示
            document.getElementById('subtotal').textContent = `¥${subtotal.toFixed(2)}`;
            document.getElementById('service-fee').textContent = `¥${serviceFee.toFixed(2)}`;
            document.getElementById('total').textContent = `¥${total.toFixed(2)}`;
        }

        // 清空订单
        function clearOrder() {
            if (order.length === 0) return;
            
            if (confirm('确定要清空当前订单吗？')) {
                order = [];
                updateOrderUI();
            }
        }

        // 提交订单
        function submitOrder() {
            if (order.length === 0) {
                alert('您的订单是空的，请先添加菜品');
                return;
            }
            
            // 获取备注
            const notes = document.getElementById('order-notes').value.trim();
            
            // 生成订单号
            const orderNumber = generateOrderNumber();
            
            // 显示订单号
            document.getElementById('order-number').textContent = `#${orderNumber}`;
            
            // 显示成功弹窗
            document.getElementById('order-success-modal').classList.remove('hidden');
            
            // 模拟订单提交
            console.log('提交订单:', {
                orderNumber,
                items: order,
                notes,
                total: document.getElementById('total').textContent,
                timestamp: new Date().toISOString()
            });
        }

        // 生成订单号
        function generateOrderNumber() {
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const random = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
            
            return `${year}${month}${day}${random}`;
        }

        // 切换主题
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('theme-toggle').querySelector('i');
            
            if (body.classList.contains('dark-theme')) {
                // 切换到亮色主题
                body.classList.remove('dark-theme');
                body.classList.remove('bg-dark');
                body.classList.add('bg-gray');
                icon.classList.remove('fa-sun-o');
                icon.classList.add('fa-moon-o');
            } else {
                // 切换到暗色主题
                body.classList.add('dark-theme');
                body.classList.remove('bg-gray');
                body.classList.add('bg-dark');
                icon.classList.remove('fa-moon-o');
                icon.classList.add('fa-sun-o');
            }
        }

        // 显示提示消息
        function showToast(message) {
            // 创建提示元素
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-primary text-dark px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in';
            toast.textContent = message;
            
            // 添加到页面
            document.body.appendChild(toast);
            
            // 2秒后移除
            setTimeout(() => {
                toast.classList.add('opacity-0', 'transition-opacity', 'duration-300');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 2000);
        }
    </script>
</body>
</html>